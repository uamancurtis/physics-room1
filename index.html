<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>电磁波小应用实验报告</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
        }
        
        .container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 28px;
        }
        
        h2 {
            color: #3498db;
            margin: 20px 0 15px;
            font-size: 22px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 5px;
        }
        
        h3 {
            color: #2980b9;
            margin: 15px 0 10px;
            font-size: 18px;
        }
        
        .basic-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
            padding: 20px;
            background-color: #ecf0f1;
            border-radius: 8px;
        }
        
        .basic-info div {
            display: flex;
            flex-direction: column;
        }
        
        .basic-info label {
            font-weight: bold;
            margin-bottom: 5px;
            color: #2c3e50;
        }
        
        .basic-info input {
            padding: 8px;
            border: 1px solid #bdc3c7;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #fafafa;
        }
        
        .section label {
            display: block;
            font-weight: bold;
            margin-bottom: 10px;
            color: #2c3e50;
        }
        
        .section textarea {
            width: 100%;
            min-height: 100px;
            padding: 10px;
            border: 1px solid #bdc3c7;
            border-radius: 4px;
            font-size: 14px;
            font-family: inherit;
            resize: vertical;
        }
        
        .section input[type="file"] {
            margin: 10px 0;
        }
        
        .step-item {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #bdc3c7;
            border-radius: 8px;
            background-color: white;
        }
        
        .step-item label {
            margin-bottom: 5px;
        }
        
        .step-item input[type="text"] {
            width: 100%;
            padding: 8px;
            border: 1px solid #bdc3c7;
            border-radius: 4px;
            font-size: 14px;
            margin-bottom: 10px;
        }
        
        .process-materials {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .material-item {
            padding: 15px;
            border: 1px dashed #3498db;
            border-radius: 8px;
            text-align: center;
            background-color: white;
        }
        
        button {
            background-color: #3498db;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            margin: 5px;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #2980b9;
        }
        
        button.add-step {
            background-color: #2ecc71;
        }
        
        button.add-step:hover {
            background-color: #27ae60;
        }
        
        button.remove-step {
            background-color: #e74c3c;
        }
        
        button.remove-step:hover {
            background-color: #c0392b;
        }
        
        .rubric {
            background-color: #e8f4f8;
            padding: 20px;
            border-radius: 8px;
            margin-top: 30px;
        }
        
        .rubric-item {
            margin-bottom: 15px;
            padding: 15px;
            border: 1px solid #b3e5fc;
            border-radius: 8px;
            background-color: white;
        }
        
        .rubric-item h4 {
            color: #0288d1;
            margin-bottom: 10px;
        }
        
        .rubric-item p {
            margin-bottom: 10px;
        }
        
        .score-levels {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        
        .score-level {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: #f5f5f5;
            text-align: center;
        }
        
        .score-level .score {
            font-weight: bold;
            color: #3498db;
            font-size: 18px;
        }
        
        .submit-section {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid #3498db;
        }
        
        #ai-score {
            margin-top: 20px;
            padding: 20px;
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 8px;
            text-align: center;
            display: none;
        }
        
        #ai-score h3 {
            color: #155724;
        }
        
        #ai-score p {
            font-size: 18px;
            color: #155724;
            margin: 10px 0;
        }
        
        #score-details {
            margin-top: 20px;
            text-align: left;
            padding: 15px;
            background-color: white;
            border-radius: 8px;
            border: 1px solid #c3e6cb;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>电磁波小应用实验报告</h1>
        
        <!-- 基本信息 -->
        <div class="basic-info">
            <div>
                <label for="student-name">学生姓名</label>
                <input type="text" id="student-name" name="student-name" required>
            </div>
            <div>
                <label for="class">班级</label>
                <input type="text" id="class" name="class" required>
            </div>
            <div>
                <label for="date">日期</label>
                <input type="date" id="date" name="date" required>
            </div>
            <div>
                <label for="experiment-title">实验标题</label>
                <input type="text" id="experiment-title" name="experiment-title" placeholder="关于电磁波的小应用" required>
            </div>
        </div>
        
        <!-- 实验目的 -->
        <div class="section">
            <label for="experiment-purpose">一、实验目的</label>
            <textarea id="experiment-purpose" name="experiment-purpose" placeholder="请明确实验要解决的问题或达到的目标..." required></textarea>
        </div>
        
        <!-- 实验原理 -->
        <div class="section">
            <label for="experiment-principle">二、实验原理</label>
            <textarea id="experiment-principle" name="experiment-principle" placeholder="请简述涉及的电磁波相关物理知识..." required></textarea>
        </div>
        
        <!-- 实验材料与工具 -->
        <div class="section">
            <label for="experiment-materials">三、实验材料与工具</label>
            <textarea id="experiment-materials" name="experiment-materials" placeholder="请列出所有需要的材料和工具..." required></textarea>
        </div>
        
        <!-- 实验设计方案 -->
        <div class="section">
            <label>四、实验设计方案</label>
            <div id="experiment-steps">
                <div class="step-item">
                    <label>实验步骤 1</label>
                    <input type="text" placeholder="步骤描述" required>
                    <textarea placeholder="操作方法和注意事项..." required></textarea>
                </div>
                <div class="step-item">
                    <label>实验步骤 2</label>
                    <input type="text" placeholder="步骤描述" required>
                    <textarea placeholder="操作方法和注意事项..." required></textarea>
                </div>
            </div>
            <button type="button" class="add-step" onclick="addStep()">添加步骤</button>
        </div>
        
        <!-- 实验过程记录 -->
        <div class="section">
            <label for="experiment-process">五、实验过程记录</label>
            <textarea id="experiment-process" name="experiment-process" placeholder="请实时记录实验过程中的现象、数据和遇到的问题..." required></textarea>
        </div>
        
        <!-- 过程性材料上传 -->
        <div class="section">
            <label>六、过程性材料（图片/视频）</label>
            <div class="process-materials">
                <div class="material-item">
                    <label>实验准备阶段</label>
                    <input type="file" accept="image/*,video/*">
                </div>
                <div class="material-item">
                    <label>实验进行阶段</label>
                    <input type="file" accept="image/*,video/*">
                </div>
                <div class="material-item">
                    <label>实验结果展示</label>
                    <input type="file" accept="image/*,video/*">
                </div>
                <div class="material-item">
                    <label>其他过程材料</label>
                    <input type="file" accept="image/*,video/*">
                </div>
            </div>
        </div>
        
        <!-- 实验结果分析 -->
        <div class="section">
            <label for="result-analysis">七、实验结果分析</label>
            <textarea id="result-analysis" name="result-analysis" placeholder="请对收集到的数据和现象进行分析..." required></textarea>
        </div>
        
        <!-- 实验结论 -->
        <div class="section">
            <label for="experiment-conclusion">八、实验结论</label>
            <textarea id="experiment-conclusion" name="experiment-conclusion" placeholder="请总结实验成果和收获..." required></textarea>
        </div>
        
        <!-- 问题与讨论 -->
        <div class="section">
            <label for="problems-discussion">九、问题与讨论</label>
            <textarea id="problems-discussion" name="problems-discussion" placeholder="请描述实验中遇到的问题和解决方案..." required></textarea>
        </div>
        
        <!-- 创新点 -->
        <div class="section">
            <label for="innovations">十、创新点</label>
            <textarea id="innovations" name="innovations" placeholder="请描述实验中的创新之处..."></textarea>
        </div>
        
        <!-- 评分规则 -->
        <div class="section rubric">
            <h2>评分规则</h2>
            <div class="rubric-item">
                <h4>1. 实验目的（10分）</h4>
                <p>明确阐述实验要解决的问题或达到的目标</p>
                <div class="score-levels">
                    <div class="score-level">
                        <div class="score">8-10分</div>
                        <div>目标明确，与电磁波主题紧密相关</div>
                    </div>
                    <div class="score-level">
                        <div class="score">5-7分</div>
                        <div>目标较明确，与主题相关</div>
                    </div>
                    <div class="score-level">
                        <div class="score">0-4分</div>
                        <div>目标不明确，与主题关联不大</div>
                    </div>
                </div>
            </div>
            
            <div class="rubric-item">
                <h4>2. 实验原理（15分）</h4>
                <p>正确运用电磁波相关物理知识</p>
                <div class="score-levels">
                    <div class="score-level">
                        <div class="score">12-15分</div>
                        <div>原理正确，知识点全面，解释清晰</div>
                    </div>
                    <div class="score-level">
                        <div class="score">8-11分</div>
                        <div>原理基本正确，知识点较全面</div>
                    </div>
                    <div class="score-level">
                        <div class="score">0-7分</div>
                        <div>原理错误或知识点不完整</div>
                    </div>
                </div>
            </div>
            
            <div class="rubric-item">
                <h4>3. 实验设计方案（20分）</h4>
                <p>实验步骤合理，方法科学</p>
                <div class="score-levels">
                    <div class="score-level">
                        <div class="score">16-20分</div>
                        <div>步骤完整，逻辑清晰，方法科学可行</div>
                    </div>
                    <div class="score-level">
                        <div class="score">10-15分</div>
                        <div>步骤较完整，逻辑较清晰</div>
                    </div>
                    <div class="score-level">
                        <div class="score">0-9分</div>
                        <div>步骤不完整，逻辑混乱</div>
                    </div>
                </div>
            </div>
            
            <div class="rubric-item">
                <h4>4. 实验过程记录（15分）</h4>
                <p>详细记录实验过程中的现象和数据</p>
                <div class="score-levels">
                    <div class="score-level">
                        <div class="score">12-15分</div>
                        <div>记录详细，数据准确，现象描述清晰</div>
                    </div>
                    <div class="score-level">
                        <div class="score">8-11分</div>
                        <div>记录较详细，数据较准确</div>
                    </div>
                    <div class="score-level">
                        <div class="score">0-7分</div>
                        <div>记录简单，数据不准确</div>
                    </div>
                </div>
            </div>
            
            <div class="rubric-item">
                <h4>5. 过程性材料（10分）</h4>
                <p>提供实验过程中的图片或视频</p>
                <div class="score-levels">
                    <div class="score-level">
                        <div class="score">8-10分</div>
                        <div>材料丰富，能完整展示实验过程</div>
                    </div>
                    <div class="score-level">
                        <div class="score">5-7分</div>
                        <div>材料较丰富，能基本展示实验过程</div>
                    </div>
                    <div class="score-level">
                        <div class="score">0-4分</div>
                        <div>材料缺乏，无法展示实验过程</div>
                    </div>
                </div>
            </div>
            
            <div class="rubric-item">
                <h4>6. 实验结果分析（10分）</h4>
                <p>对实验结果进行科学分析</p>
                <div class="score-levels">
                    <div class="score-level">
                        <div class="score">8-10分</div>
                        <div>分析深入，结论合理，逻辑严谨</div>
                    </div>
                    <div class="score-level">
                        <div class="score">5-7分</div>
                        <div>分析较深入，结论较合理</div>
                    </div>
                    <div class="score-level">
                        <div class="score">0-4分</div>
                        <div>分析肤浅，结论不合理</div>
                    </div>
                </div>
            </div>
            
            <div class="rubric-item">
                <h4>7. 实验结论（10分）</h4>
                <p>总结实验成果</p>
                <div class="score-levels">
                    <div class="score-level">
                        <div class="score">8-10分</div>
                        <div>结论明确，与实验目的一致，体现电磁波知识应用</div>
                    </div>
                    <div class="score-level">
                        <div class="score">5-7分</div>
                        <div>结论较明确，与实验目的较一致</div>
                    </div>
                    <div class="score-level">
                        <div class="score">0-4分</div>
                        <div>结论不明确，与实验目的不符</div>
                    </div>
                </div>
            </div>
            
            <div class="rubric-item">
                <h4>8. 创新点（10分）</h4>
                <p>实验中的创新之处</p>
                <div class="score-levels">
                    <div class="score-level">
                        <div class="score">8-10分</div>
                        <div>有明显创新，方法独特，体现创造性思维</div>
                    </div>
                    <div class="score-level">
                        <div class="score">5-7分</div>
                        <div>有一定创新，方法有改进</div>
                    </div>
                    <div class="score-level">
                        <div class="score">0-4分</div>
                        <div>无创新，方法常规</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 学生得分记录 -->
        <div class="section">
            <h2>学生得分记录</h2>
            <table id="score-records" style="width: 100%; border-collapse: collapse;">
                <thead>
                    <tr style="background-color: #3498db; color: white;">
                        <th style="border: 1px solid #bdc3c7; padding: 8px; text-align: left;">序号</th>
                        <th style="border: 1px solid #bdc3c7; padding: 8px; text-align: left;">学生姓名</th>
                        <th style="border: 1px solid #bdc3c7; padding: 8px; text-align: left;">班级</th>
                        <th style="border: 1px solid #bdc3c7; padding: 8px; text-align: left;">日期</th>
                        <th style="border: 1px solid #bdc3c7; padding: 8px; text-align: left;">得分</th>
                    </tr>
                </thead>
                <tbody id="records-body">
                    <!-- 记录将通过JavaScript动态添加 -->
                </tbody>
            </table>
        </div>
        
        <!-- 提交和AI评分 -->
        <div class="submit-section">
            <button type="button" onclick="submitReport()">提交实验报告</button>
            <div id="ai-score">
                <h3>AI评分结果</h3>
                <p>总得分：<span id="total-score">0</span>/100分</p>
                <div id="score-details"></div>
            </div>
        </div>
    </div>
    
    <script>
        // 添加实验步骤
        function addStep() {
            const stepsContainer = document.getElementById('experiment-steps');
            const stepCount = stepsContainer.children.length + 1;
            const stepItem = document.createElement('div');
            stepItem.className = 'step-item';
            stepItem.innerHTML = `
                <label>实验步骤 ${stepCount}</label>
                <input type="text" placeholder="步骤描述" required>
                <textarea placeholder="操作方法和注意事项..." required></textarea>
                <button type="button" class="remove-step" onclick="removeStep(this)">删除步骤</button>
            `;
            stepsContainer.appendChild(stepItem);
        }
        
        // 删除实验步骤
        function removeStep(button) {
            const stepItem = button.parentElement;
            const stepsContainer = document.getElementById('experiment-steps');
            if (stepsContainer.children.length > 2) {
                stepItem.remove();
                // 更新步骤编号
                updateStepNumbers();
            } else {
                alert('至少需要保留2个实验步骤');
            }
        }
        
        // 更新步骤编号
        function updateStepNumbers() {
            const steps = document.querySelectorAll('.step-item');
            steps.forEach((step, index) => {
                const label = step.querySelector('label');
                label.textContent = `实验步骤 ${index + 1}`;
            });
        }
        
        // 提交报告并进行AI评分
        function submitReport() {
            // 获取表单数据
            const formData = {
                studentName: document.getElementById('student-name').value,
                className: document.getElementById('class').value,
                date: document.getElementById('date').value,
                title: document.getElementById('experiment-title').value,
                purpose: document.getElementById('experiment-purpose').value,
                principle: document.getElementById('experiment-principle').value,
                materials: document.getElementById('experiment-materials').value,
                steps: Array.from(document.querySelectorAll('#experiment-steps .step-item')).map((step, index) => ({
                    number: index + 1,
                    description: step.querySelector('input[type="text"]').value,
                    details: step.querySelector('textarea').value
                })),
                process: document.getElementById('experiment-process').value,
                analysis: document.getElementById('result-analysis').value,
                conclusion: document.getElementById('experiment-conclusion').value,
                problems: document.getElementById('problems-discussion').value,
                innovations: document.getElementById('innovations').value
            };
            
            // 进行AI评分（基于规则的评分）
            const scores = calculateAIScore(formData);
            
            // 显示评分结果
            displayScore(scores);
        }
        
        // AI评分逻辑
        function calculateAIScore(formData) {
            const scores = {
                purpose: scorePurpose(formData.purpose),
                principle: scorePrinciple(formData.principle),
                design: scoreDesign(formData.steps),
                process: scoreProcess(formData.process),
                materials: scoreMaterials(formData.materials),
                analysis: scoreAnalysis(formData.analysis),
                conclusion: scoreConclusion(formData.conclusion),
                innovations: scoreInnovations(formData.innovations)
            };
            
            scores.total = Object.values(scores).reduce((sum, score) => sum + score, 0);
            return scores;
        }
        
        // 评分函数
        function scorePurpose(purpose) {
            if (purpose.length < 50) return 4;
            if (purpose.length < 100) return 7;
            if (purpose.includes('电磁波') && purpose.includes('应用')) return 10;
            return 8;
        }
        
        function scorePrinciple(principle) {
            if (principle.length < 100) return 7;
            if (principle.length < 200) return 12;
            const keywords = ['电磁波', '波长', '频率', '传播', '应用'];
            const matchCount = keywords.filter(keyword => principle.includes(keyword)).length;
            if (matchCount >= 3) return 15;
            return 13;
        }
        
        function scoreDesign(steps) {
            if (steps.length < 3) return 9;
            if (steps.length < 5) return 15;
            const hasDetails = steps.every(step => step.details.length > 50);
            if (hasDetails) return 20;
            return 18;
        }
        
        function scoreProcess(process) {
            if (process.length < 100) return 7;
            if (process.length < 200) return 12;
            if (process.includes('数据') && process.includes('现象')) return 15;
            return 13;
        }
        
        function scoreMaterials(materials) {
            const materialList = materials.split('\n').filter(item => item.trim() !== '');
            if (materialList.length < 3) return 4;
            if (materialList.length < 5) return 7;
            return 10;
        }
        
        function scoreAnalysis(analysis) {
            if (analysis.length < 100) return 4;
            if (analysis.length < 200) return 7;
            if (analysis.includes('分析') && analysis.includes('结论')) return 10;
            return 8;
        }
        
        function scoreConclusion(conclusion) {
            if (conclusion.length < 50) return 4;
            if (conclusion.length < 100) return 7;
            if (conclusion.includes('电磁波') && conclusion.includes('应用')) return 10;
            return 8;
        }
        
        function scoreInnovations(innovations) {
            if (innovations.length < 50) return 4;
            if (innovations.length < 100) return 7;
            if (innovations.includes('创新') || innovations.includes('改进')) return 10;
            return 8;
        }
        
        // 保存得分记录到本地存储
        function saveScoreRecord(studentName, className, date, totalScore) {
            // 获取现有记录
            const records = JSON.parse(localStorage.getItem('experimentScores')) || [];
            
            // 添加新记录
            const newRecord = {
                id: Date.now(),
                studentName,
                className,
                date,
                totalScore,
                timestamp: new Date().toISOString()
            };
            
            records.push(newRecord);
            
            // 保存回本地存储
            localStorage.setItem('experimentScores', JSON.stringify(records));
            
            // 更新显示
            displayScoreRecords();
        }
        
        // 显示得分记录
        function displayScoreRecords() {
            const records = JSON.parse(localStorage.getItem('experimentScores')) || [];
            const recordsBody = document.getElementById('records-body');
            
            // 清空现有记录
            recordsBody.innerHTML = '';
            
            // 添加记录
            records.forEach((record, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td style="border: 1px solid #bdc3c7; padding: 8px;">${index + 1}</td>
                    <td style="border: 1px solid #bdc3c7; padding: 8px;">${record.studentName}</td>
                    <td style="border: 1px solid #bdc3c7; padding: 8px;">${record.className}</td>
                    <td style="border: 1px solid #bdc3c7; padding: 8px;">${record.date}</td>
                    <td style="border: 1px solid #bdc3c7; padding: 8px;">${record.totalScore}</td>
                `;
                recordsBody.appendChild(row);
            });
        }
        
        // 显示评分结果
        function displayScore(scores) {
            const scoreElement = document.getElementById('ai-score');
            const totalScoreElement = document.getElementById('total-score');
            const scoreDetailsElement = document.getElementById('score-details');
            
            totalScoreElement.textContent = scores.total;
            
            scoreDetailsElement.innerHTML = `
                <p><strong>实验目的：</strong>${scores.purpose}/10分</p>
                <p><strong>实验原理：</strong>${scores.principle}/15分</p>
                <p><strong>实验设计：</strong>${scores.design}/20分</p>
                <p><strong>实验过程：</strong>${scores.process}/15分</p>
                <p><strong>实验材料：</strong>${scores.materials}/10分</p>
                <p><strong>结果分析：</strong>${scores.analysis}/10分</p>
                <p><strong>实验结论：</strong>${scores.conclusion}/10分</p>
                <p><strong>创新点：</strong>${scores.innovations}/10分</p>
            `;
            
            scoreElement.style.display = 'block';
            
            // 保存得分记录
            const studentName = document.getElementById('student-name').value;
            const className = document.getElementById('class').value;
            const date = document.getElementById('date').value;
            saveScoreRecord(studentName, className, date, scores.total);
        }
        
        // 页面加载时显示得分记录
        window.onload = function() {
            displayScoreRecords();
        }
    </script>
</body>
</html>